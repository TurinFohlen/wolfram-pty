# tensorflow.yaml — TensorFlow/Keras → Wolfram Language 映射规则（~55 条）
# 聚焦：数学运算 + 张量操作 + keras 层（WL NetTrain 体系）

# ═══════════════════════════════════════════════════════
#  1. 张量创建
# ═══════════════════════════════════════════════════════

- python_path: tf.constant
  wolfram_function: ConstantArray
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [constant, create, tensorflow]
  description: "Create constant tensor 创建常量张量"

- python_path: tf.zeros
  wolfram_function: ConstantArray
  input_converters: [to_wl_scalar, to_wl_list]
  output_converter: from_wl_numpy
  tags: [zeros, create, tensorflow]
  description: "Zero tensor 全零张量"

- python_path: tf.ones
  wolfram_function: ConstantArray
  input_converters: [to_wl_scalar, to_wl_list]
  output_converter: from_wl_numpy
  tags: [ones, create, tensorflow]
  description: "Ones tensor 全一张量"

- python_path: tf.fill
  wolfram_function: ConstantArray
  input_converters: [to_wl_list, to_wl_scalar]
  output_converter: from_wl_numpy
  tags: [fill, create, tensorflow]
  description: "Fill tensor with value 填充张量"

- python_path: tf.eye
  wolfram_function: IdentityMatrix
  input_converter: to_wl_scalar
  output_converter: from_wl_numpy
  tags: [eye, identity, matrix, tensorflow]
  description: "Identity matrix 单位矩阵"

- python_path: tf.linspace
  wolfram_function: Subdivide
  input_converter: to_wl_scalar
  output_converter: from_wl_numpy
  tags: [linspace, sequence, tensorflow]
  description: "Linear sequence 线性间隔序列"

- python_path: tf.range
  wolfram_function: Range
  input_converter: to_wl_scalar
  output_converter: from_wl_numpy
  tags: [range, arange, sequence, tensorflow]
  description: "Range sequence 序列"

# ═══════════════════════════════════════════════════════
#  2. 张量操作
# ═══════════════════════════════════════════════════════

- python_path: tf.reshape
  wolfram_function: ArrayReshape
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [reshape, shape, tensorflow]
  description: "Reshape tensor 重塑张量"

- python_path: tf.transpose
  wolfram_function: Transpose
  input_converter: to_wl_matrix
  output_converter: from_wl_numpy
  tags: [transpose, matrix, tensorflow]
  description: "Transpose tensor 转置"

- python_path: tf.squeeze
  wolfram_function: Flatten
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [squeeze, shape, tensorflow]
  description: "Remove size-1 dimensions 去除单维"

- python_path: tf.expand_dims
  wolfram_function: List
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [expand_dims, shape, tensorflow]
  description: "Insert dimension 插入维度"

- python_path: tf.concat
  wolfram_function: Join
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [concat, concatenate, tensorflow]
  description: "Concatenate tensors 连接张量"

- python_path: tf.stack
  wolfram_function: Join
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [stack, join, tensorflow]
  description: "Stack tensors 堆叠张量"

- python_path: tf.split
  wolfram_function: Partition
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [split, partition, tensorflow]
  description: "Split tensor 分割张量"

- python_path: tf.reverse
  wolfram_function: Reverse
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [reverse, flip, tensorflow]
  description: "Reverse tensor 翻转张量"

- python_path: tf.clip_by_value
  wolfram_function: Clip
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [clip, clamp, tensorflow]
  description: "Clip tensor values 截断值"

- python_path: tf.where
  wolfram_function: Pick
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [where, conditional, tensorflow]
  description: "Conditional selection 条件选择"

- python_path: tf.sort
  wolfram_function: Sort
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [sort, order, tensorflow]
  description: "Sort tensor 排序"

# ═══════════════════════════════════════════════════════
#  3. 数学运算（广播）
# ═══════════════════════════════════════════════════════

- python_path: tf.add
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Plus]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [add, broadcast, tensorflow]
  description: "Add with broadcasting 广播加法"

- python_path: tf.subtract
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Subtract]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [subtract, broadcast, tensorflow]
  description: "Subtract with broadcasting 广播减法"

- python_path: tf.multiply
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Times]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [multiply, broadcast, tensorflow]
  description: "Multiply with broadcasting 广播乘法"

- python_path: tf.divide
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Divide]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [divide, broadcast, tensorflow]
  description: "Divide with broadcasting 广播除法"

- python_path: tf.pow
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Power]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [pow, power, broadcast, tensorflow]
  description: "Power with broadcasting 广播幂"

- python_path: tf.abs
  wolfram_function: Abs
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [abs, tensorflow]
  description: "Absolute value 绝对值"

- python_path: tf.sqrt
  wolfram_function: Sqrt
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [sqrt, tensorflow]
  description: "Square root 平方根"

- python_path: tf.exp
  wolfram_function: Exp
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [exp, tensorflow]
  description: "Exponential 指数"

- python_path: tf.math.log
  wolfram_function: Log
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [log, logarithm, tensorflow]
  description: "Natural log 自然对数"

- python_path: tf.sin
  wolfram_function: Sin
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [sin, trig, tensorflow]
  description: "Sine 正弦"

- python_path: tf.cos
  wolfram_function: Cos
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [cos, trig, tensorflow]
  description: "Cosine 余弦"

# ═══════════════════════════════════════════════════════
#  4. 线性代数
# ═══════════════════════════════════════════════════════

- python_path: tf.linalg.matmul
  wolfram_function: Dot
  input_converters: [to_wl_matrix, to_wl_matrix]
  output_converter: from_wl_numpy
  tags: [matmul, matrix multiply, tensorflow]
  description: "Matrix multiply 矩阵乘法"

- python_path: tf.linalg.inv
  wolfram_function: Inverse
  input_converter: to_wl_matrix
  output_converter: from_wl_numpy
  tags: [inv, inverse, tensorflow]
  description: "Matrix inverse 矩阵逆"

- python_path: tf.linalg.det
  wolfram_function: Det
  input_converter: to_wl_matrix
  output_converter: from_wl_scalar
  tags: [det, determinant, tensorflow]
  description: "Matrix determinant 行列式"

- python_path: tf.linalg.eig
  wolfram_function: Eigensystem
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [eig, eigenvalue, tensorflow]
  description: "Eigendecomposition 特征分解"

- python_path: tf.linalg.svd
  wolfram_function: SingularValueDecomposition
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [svd, decomposition, tensorflow]
  description: "SVD 奇异值分解"

- python_path: tf.linalg.norm
  wolfram_function: Norm
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [norm, vector, tensorflow]
  description: "Norm 范数"

- python_path: tf.linalg.solve
  wolfram_function: LinearSolve
  input_converters: [to_wl_matrix, to_wl_list]
  output_converter: from_wl_numpy
  tags: [solve, linear algebra, tensorflow]
  description: "Solve linear system 线性方程组"

- python_path: tf.linalg.trace
  wolfram_function: Tr
  input_converter: to_wl_matrix
  output_converter: from_wl_scalar
  tags: [trace, matrix, tensorflow]
  description: "Matrix trace 迹"

# ═══════════════════════════════════════════════════════
#  5. 统计聚合
# ═══════════════════════════════════════════════════════

- python_path: tf.reduce_sum
  wolfram_function: Total
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [sum, aggregate, tensorflow]
  description: "Sum reduction 求和规约"

- python_path: tf.reduce_mean
  wolfram_function: Mean
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [mean, average, tensorflow]
  description: "Mean reduction 均值规约"

- python_path: tf.reduce_max
  wolfram_function: Max
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [max, maximum, tensorflow]
  description: "Max reduction 最大值规约"

- python_path: tf.reduce_min
  wolfram_function: Min
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [min, minimum, tensorflow]
  description: "Min reduction 最小值规约"

- python_path: tf.reduce_prod
  wolfram_function: "Times @@ Flatten[#]&"
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [prod, product, tensorflow]
  description: "Product reduction 乘积规约"

- python_path: tf.reduce_std
  wolfram_function: StandardDeviation
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [std, standard deviation, tensorflow]
  description: "Standard deviation 标准差规约"

- python_path: tf.reduce_variance
  wolfram_function: Variance
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [var, variance, tensorflow]
  description: "Variance reduction 方差规约"

- python_path: tf.argmax
  wolfram_function: "Ordering[Flatten[#], -1][[1]]&"
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [argmax, index, tensorflow]
  description: "Index of maximum 最大值索引"

- python_path: tf.argmin
  wolfram_function: "Ordering[Flatten[#], 1][[1]]&"
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [argmin, index, tensorflow]
  description: "Index of minimum 最小值索引"

- python_path: tf.cumsum
  wolfram_function: Accumulate
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [cumsum, cumulative sum, tensorflow]
  description: "Cumulative sum 累积和"

# ═══════════════════════════════════════════════════════
#  6. 随机数
# ═══════════════════════════════════════════════════════

- python_path: tf.random.uniform
  wolfram_function: RandomReal
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [random, uniform, tensorflow]
  description: "Uniform random tensor 均匀随机张量"

- python_path: tf.random.normal
  wolfram_function: "RandomVariate[NormalDistribution[]]"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [random, normal, gaussian, tensorflow]
  description: "Normal random tensor 正态随机张量"

- python_path: tf.random.set_seed
  wolfram_function: SeedRandom
  input_converter: to_wl_scalar
  output_converter: from_wl_passthrough
  tags: [seed, random, tensorflow]
  description: "Set random seed 设置随机种子"

# ═══════════════════════════════════════════════════════
#  7. 神经网络激活函数（nn.functional 对等）
# ═══════════════════════════════════════════════════════

- python_path: tf.nn.relu
  wolfram_function: "Map[Max[0, #]&, #, {-1}]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [relu, activation, tensorflow, nn]
  description: "ReLU activation ReLU激活"

- python_path: tf.nn.sigmoid
  wolfram_function: "Map[LogisticSigmoid, Flatten[#]]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [sigmoid, activation, tensorflow, nn]
  description: "Sigmoid activation Sigmoid激活"

- python_path: tf.nn.softmax
  wolfram_function: "SoftmaxLayer[][#]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [softmax, activation, tensorflow, nn]
  description: "Softmax activation Softmax激活"

- python_path: tf.nn.tanh
  wolfram_function: Tanh
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [tanh, activation, tensorflow, nn]
  description: "Tanh activation Tanh激活"

- python_path: tf.nn.leaky_relu
  wolfram_function: "Map[If[#>0, #, 0.01*#]&, Flatten[#]]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [leaky_relu, activation, tensorflow, nn]
  description: "Leaky ReLU activation Leaky ReLU激活"
