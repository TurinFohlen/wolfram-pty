# sklearn.yaml — scikit-learn → Wolfram Language 映射规则（~55 条）
# 覆盖：preprocessing / decomposition / cluster / regression / classification / metrics / model_selection

# ═══════════════════════════════════════════════════════
#  1. 预处理 preprocessing
# ═══════════════════════════════════════════════════════

- python_path: sklearn.preprocessing.scale
  wolfram_function: Standardize
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [scale, standardize, normalize, sklearn]
  description: "Standardize features (WL: Standardize) 特征标准化"

- python_path: sklearn.preprocessing.normalize
  wolfram_function: Normalize
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [normalize, unit norm, sklearn]
  description: "Normalize samples to unit norm (WL: Normalize) 归一化"

- python_path: sklearn.preprocessing.MinMaxScaler
  wolfram_function: Rescale
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [minmax, rescale, sklearn]
  description: "Min-max scaling (WL: Rescale) 最小最大缩放"

- python_path: sklearn.preprocessing.StandardScaler
  wolfram_function: Standardize
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [standard scaler, z-score, sklearn]
  description: "Z-score standardization (WL: Standardize) Z分数标准化"

- python_path: sklearn.preprocessing.RobustScaler
  wolfram_function: "Standardize[#, Median, InterquartileRange]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [robust scaler, median, iqr, sklearn]
  description: "Robust scaling (WL: Standardize with IQR) 鲁棒缩放"

- python_path: sklearn.preprocessing.LabelEncoder
  wolfram_function: "AssociationThread[DeleteDuplicates[#] -> Range[Length[DeleteDuplicates[#]]]]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [label encoder, encode, categorical, sklearn]
  description: "Encode categorical labels 标签编码"

- python_path: sklearn.preprocessing.OneHotEncoder
  wolfram_function: "SparseArray[EncodeCategorical]"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [one hot, onehot, encode, sklearn]
  description: "One-hot encoding (WL: EncodeCategorical) 独热编码"

- python_path: sklearn.preprocessing.OrdinalEncoder
  wolfram_function: "Map[AssociationThread[Union[#] -> Range[Length[Union[#]]]], Transpose[#]]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [ordinal encoder, encode, sklearn]
  description: "Ordinal encoding 序数编码"

- python_path: sklearn.preprocessing.PolynomialFeatures
  wolfram_function: "Table[{x^i}, {i, 0, #2}]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [polynomial features, feature engineering, sklearn]
  description: "Polynomial feature expansion 多项式特征扩展"

- python_path: sklearn.preprocessing.Binarizer
  wolfram_function: "Map[If[#>=#2, 1, 0]&, Flatten[#1]]&"
  input_converters: [to_wl_list, to_wl_scalar]
  output_converter: from_wl_numpy
  tags: [binarize, threshold, sklearn]
  description: "Binarize values by threshold 按阈值二值化"

- python_path: sklearn.preprocessing.power_transform
  wolfram_function: "Log[1 + #]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [power transform, yeo-johnson, sklearn]
  description: "Power transform for normality 幂变换"

- python_path: sklearn.preprocessing.quantile_transform
  wolfram_function: "EmpiricalDistribution[#]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [quantile transform, uniform, sklearn]
  description: "Quantile transformation 分位数变换"

# ═══════════════════════════════════════════════════════
#  2. 降维 decomposition
# ═══════════════════════════════════════════════════════

- python_path: sklearn.decomposition.PCA
  wolfram_function: PrincipalComponents
  input_converter: to_wl_matrix
  output_converter: from_wl_numpy
  tags: [pca, dimensionality reduction, sklearn]
  description: "Principal Component Analysis (WL: PrincipalComponents) 主成分分析"

- python_path: sklearn.decomposition.TruncatedSVD
  wolfram_function: SingularValueDecomposition
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [svd, truncated svd, sklearn]
  description: "Truncated SVD (WL: SingularValueDecomposition) 截断奇异值分解"

- python_path: sklearn.decomposition.NMF
  wolfram_function: "ResourceFunction[\"NonNegativeMatrixFactorization\"]"
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [nmf, non-negative, factorization, sklearn]
  description: "Non-negative matrix factorization 非负矩阵分解"

- python_path: sklearn.decomposition.FastICA
  wolfram_function: "ResourceFunction[\"IndependentComponentAnalysis\"]"
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [ica, independent components, sklearn]
  description: "Independent Component Analysis 独立成分分析"

- python_path: sklearn.decomposition.FactorAnalysis
  wolfram_function: "FactorAnalysis"
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [factor analysis, sklearn]
  description: "Factor Analysis 因子分析"

- python_path: sklearn.manifold.TSNE
  wolfram_function: DimensionReduce
  input_converter: to_wl_matrix
  output_converter: from_wl_numpy
  tags: [tsne, embedding, manifold, sklearn]
  description: "t-SNE embedding (WL: DimensionReduce) t-SNE降维"

- python_path: sklearn.manifold.UMAP
  wolfram_function: DimensionReduce
  input_converter: to_wl_matrix
  output_converter: from_wl_numpy
  tags: [umap, embedding, manifold, sklearn]
  description: "UMAP embedding (WL: DimensionReduce) UMAP降维"

# ═══════════════════════════════════════════════════════
#  3. 聚类 cluster
# ═══════════════════════════════════════════════════════

- python_path: sklearn.cluster.KMeans
  wolfram_function: FindClusters
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [kmeans, cluster, sklearn]
  description: "K-Means clustering (WL: FindClusters) K均值聚类"

- python_path: sklearn.cluster.AgglomerativeClustering
  wolfram_function: HierarchicalClustering
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [agglomerative, hierarchical, cluster, sklearn]
  description: "Agglomerative clustering 层次聚类"

- python_path: sklearn.cluster.DBSCAN
  wolfram_function: "FindClusters[#, Method->\"DBSCAN\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [dbscan, density, cluster, sklearn]
  description: "DBSCAN density-based clustering 密度聚类"

- python_path: sklearn.cluster.MeanShift
  wolfram_function: "FindClusters[#, Method->\"MeanShift\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [mean shift, cluster, sklearn]
  description: "Mean shift clustering 均值漂移聚类"

- python_path: sklearn.cluster.SpectralClustering
  wolfram_function: "FindClusters[#, Method->\"Spectral\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [spectral, cluster, sklearn]
  description: "Spectral clustering 谱聚类"

- python_path: sklearn.cluster.GaussianMixture
  wolfram_function: "FindClusters[#, Method->\"GaussianMixture\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [gmm, gaussian mixture, cluster, sklearn]
  description: "Gaussian Mixture Model 高斯混合模型"

# ═══════════════════════════════════════════════════════
#  4. 回归 regression
# ═══════════════════════════════════════════════════════

- python_path: sklearn.linear_model.LinearRegression
  wolfram_function: LinearModelFit
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [linear regression, ols, sklearn]
  description: "OLS linear regression (WL: LinearModelFit) 线性回归"

- python_path: sklearn.linear_model.Ridge
  wolfram_function: "LinearModelFit[#, #2, x, Method->\"L2Regularization\"]&"
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [ridge, l2, regression, sklearn]
  description: "Ridge (L2) regression L2正则线性回归"

- python_path: sklearn.linear_model.Lasso
  wolfram_function: "LinearModelFit[#, #2, x, Method->\"L1Regularization\"]&"
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [lasso, l1, regression, sklearn]
  description: "Lasso (L1) regression L1正则线性回归"

- python_path: sklearn.linear_model.ElasticNet
  wolfram_function: "LinearModelFit[#, #2, x, Method->\"ElasticNet\"]&"
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [elastic net, l1 l2, regression, sklearn]
  description: "Elastic Net regression L1+L2正则回归"

- python_path: sklearn.linear_model.LogisticRegression
  wolfram_function: "Classify[#, Method->\"LogisticRegression\"]&"
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [logistic regression, classification, sklearn]
  description: "Logistic regression (WL: Classify) Logistic回归"

- python_path: sklearn.linear_model.BayesianRidge
  wolfram_function: "LinearModelFit[#, #2, x, Method->\"Bayesian\"]&"
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [bayesian ridge, bayes, regression, sklearn]
  description: "Bayesian Ridge regression 贝叶斯岭回归"

- python_path: sklearn.svm.SVR
  wolfram_function: "Predict[#, Method->\"SupportVectorMachine\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [svr, svm, regression, sklearn]
  description: "Support Vector Regression (WL: Predict with SVM) 支持向量回归"

- python_path: sklearn.tree.DecisionTreeRegressor
  wolfram_function: "Predict[#, Method->\"DecisionTree\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [decision tree, regression, sklearn]
  description: "Decision tree regressor 决策树回归"

- python_path: sklearn.ensemble.RandomForestRegressor
  wolfram_function: "Predict[#, Method->\"RandomForest\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [random forest, ensemble, regression, sklearn]
  description: "Random forest regressor (WL: Predict) 随机森林回归"

- python_path: sklearn.ensemble.GradientBoostingRegressor
  wolfram_function: "Predict[#, Method->\"GradientBoostedTrees\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [gradient boosting, xgboost, regression, sklearn]
  description: "Gradient boosting regressor 梯度提升回归"

# ═══════════════════════════════════════════════════════
#  5. 分类 classification
# ═══════════════════════════════════════════════════════

- python_path: sklearn.svm.SVC
  wolfram_function: "Classify[#, Method->\"SupportVectorMachine\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [svc, svm, classification, sklearn]
  description: "Support Vector Classifier (WL: Classify) 支持向量分类"

- python_path: sklearn.tree.DecisionTreeClassifier
  wolfram_function: "Classify[#, Method->\"DecisionTree\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [decision tree, classification, sklearn]
  description: "Decision tree classifier 决策树分类"

- python_path: sklearn.ensemble.RandomForestClassifier
  wolfram_function: "Classify[#, Method->\"RandomForest\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [random forest, ensemble, classification, sklearn]
  description: "Random forest classifier 随机森林分类"

- python_path: sklearn.naive_bayes.GaussianNB
  wolfram_function: "Classify[#, Method->\"NaiveBayes\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [naive bayes, gaussian, classification, sklearn]
  description: "Gaussian Naive Bayes 高斯朴素贝叶斯"

- python_path: sklearn.neighbors.KNeighborsClassifier
  wolfram_function: "Classify[#, Method->\"NearestNeighbors\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [knn, nearest neighbors, classification, sklearn]
  description: "K-Nearest Neighbors classifier K近邻分类"

- python_path: sklearn.neural_network.MLPClassifier
  wolfram_function: "Classify[#, Method->\"NeuralNetwork\"]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [mlp, neural network, classification, sklearn]
  description: "MLP neural network classifier 多层感知机分类"

# ═══════════════════════════════════════════════════════
#  6. 评估指标 metrics
# ═══════════════════════════════════════════════════════

- python_path: sklearn.metrics.accuracy_score
  wolfram_function: "Mean[MapThread[Equal, {#1, #2}]]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [accuracy, metrics, sklearn]
  description: "Classification accuracy (WL: mean of matches) 分类准确率"

- python_path: sklearn.metrics.precision_score
  wolfram_function: "Mean[Pick[#1, #2, 1]]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [precision, metrics, sklearn]
  description: "Precision score 精确率"

- python_path: sklearn.metrics.recall_score
  wolfram_function: "Length[Intersection[#1, #2]]/Length[#1]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [recall, sensitivity, metrics, sklearn]
  description: "Recall score 召回率"

- python_path: sklearn.metrics.f1_score
  wolfram_function: "2*p*r/(p+r)&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [f1, f measure, metrics, sklearn]
  description: "F1 score 调和平均数"

- python_path: sklearn.metrics.mean_squared_error
  wolfram_function: "Mean[(#1-#2)^2]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [mse, mean squared error, regression, sklearn]
  description: "Mean squared error (WL: Mean of squared diffs) 均方误差"

- python_path: sklearn.metrics.mean_absolute_error
  wolfram_function: "Mean[Abs[#1-#2]]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [mae, mean absolute error, sklearn]
  description: "Mean absolute error 平均绝对误差"

- python_path: sklearn.metrics.r2_score
  wolfram_function: "1 - Total[(#1-#2)^2]/Total[(#1-Mean[#1])^2]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [r2, r squared, sklearn]
  description: "R² coefficient of determination R²决定系数"

- python_path: sklearn.metrics.confusion_matrix
  wolfram_function: "Table[Length[Select[Thread[{#1, #2}], #=={i, j}&]], {i, Union[#1]}, {j, Union[#2]}]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [confusion matrix, metrics, sklearn]
  description: "Confusion matrix 混淆矩阵"

- python_path: sklearn.metrics.roc_auc_score
  wolfram_function: "ResourceFunction[\"ROCAUC\"]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [roc auc, auc, sklearn]
  description: "ROC-AUC score ROC曲线下面积"

- python_path: sklearn.metrics.classification_report
  wolfram_function: "Table[{u, Mean[Pick[#2, #1, u]]}, {u, Union[#1]}]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_json
  tags: [classification report, metrics, sklearn]
  description: "Classification report 分类报告"

- python_path: sklearn.metrics.log_loss
  wolfram_function: "CrossEntropy[#1, #2]&"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [log loss, cross entropy, sklearn]
  description: "Log loss / cross entropy 交叉熵损失"

- python_path: sklearn.metrics.silhouette_score
  wolfram_function: "ResourceFunction[\"SilhouetteScore\"]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [silhouette, clustering, metrics, sklearn]
  description: "Silhouette score for clustering 轮廓系数"

# ═══════════════════════════════════════════════════════
#  7. 模型选择 model_selection
# ═══════════════════════════════════════════════════════

- python_path: sklearn.model_selection.train_test_split
  wolfram_function: "With[{n=Round[Length[#]*#2]}, {Take[#, n], Drop[#, n]}]&"
  input_converters: [to_wl_list, to_wl_scalar]
  output_converter: from_wl_json
  tags: [train test split, model selection, sklearn]
  description: "Train/test split (WL: Take/Drop) 训练测试集分割"

- python_path: sklearn.model_selection.cross_val_score
  wolfram_function: "ResourceFunction[\"CrossValidationScore\"]"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [cross validation, cv, sklearn]
  description: "Cross-validation scores 交叉验证得分"

- python_path: sklearn.model_selection.GridSearchCV
  wolfram_function: "ResourceFunction[\"GridSearch\"]"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [grid search, hyperparameter, sklearn]
  description: "Grid search CV 网格搜索交叉验证"

- python_path: sklearn.model_selection.KFold
  wolfram_function: "Partition[RandomSample[Range[Length[#]]], Ceiling[Length[#]/#2]]&"
  input_converters: [to_wl_list, to_wl_scalar]
  output_converter: from_wl_json
  tags: [kfold, cross validation, sklearn]
  description: "K-Fold cross-validation K折交叉验证"

- python_path: sklearn.model_selection.StratifiedKFold
  wolfram_function: "GroupBy[#, Last]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [stratified kfold, sklearn]
  description: "Stratified K-Fold 分层K折交叉验证"

# ═══════════════════════════════════════════════════════
#  8. 特征选择 feature_selection
# ═══════════════════════════════════════════════════════

- python_path: sklearn.feature_selection.SelectKBest
  wolfram_function: "TakeLargestBy[#, Last, #2][[All, 1]]&"
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [feature selection, select k best, sklearn]
  description: "Select K best features 选择最优K特征"

- python_path: sklearn.feature_selection.VarianceThreshold
  wolfram_function: "Select[Transpose[#], Variance[#]>=#2&]&"
  input_converters: [to_wl_matrix, to_wl_scalar]
  output_converter: from_wl_numpy
  tags: [variance threshold, feature selection, sklearn]
  description: "Feature selection by variance threshold 方差阈值特征选择"
