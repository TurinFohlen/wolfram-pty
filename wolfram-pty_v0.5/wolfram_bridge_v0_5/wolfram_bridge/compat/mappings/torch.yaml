# torch.yaml — PyTorch → Wolfram Language 映射规则（~65 条）
# 聚焦：张量数学运算 + 线代 + 激活函数 + 初始化
# nn.Module/DataLoader 等面向对象层不在此列（WL 对等是 NetTrain 体系）

# ═══════════════════════════════════════════════════════
#  1. 张量创建 Tensor Creation
# ═══════════════════════════════════════════════════════

- python_path: torch.tensor
  wolfram_function: Identity
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [tensor, create, torch]
  description: "Create tensor 创建张量"

- python_path: torch.zeros
  wolfram_function: ConstantArray
  input_converters: [to_wl_scalar, to_wl_list]
  output_converter: from_wl_numpy
  tags: [zeros, create, torch]
  description: "Zero tensor 全零张量"

- python_path: torch.ones
  wolfram_function: ConstantArray
  input_converters: [to_wl_scalar, to_wl_list]
  output_converter: from_wl_numpy
  tags: [ones, create, torch]
  description: "Ones tensor 全一张量"

- python_path: torch.full
  wolfram_function: ConstantArray
  input_converters: [to_wl_list, to_wl_scalar]
  output_converter: from_wl_numpy
  tags: [full, create, torch]
  description: "Filled tensor 填充张量"

- python_path: torch.arange
  wolfram_function: Range
  input_converter: to_wl_scalar
  output_converter: from_wl_numpy
  tags: [arange, range, sequence, torch]
  description: "Sequence tensor 等差序列张量"

- python_path: torch.linspace
  wolfram_function: Subdivide
  input_converter: to_wl_scalar
  output_converter: from_wl_numpy
  tags: [linspace, sequence, torch]
  description: "Linear sequence tensor 线性间隔序列"

- python_path: torch.eye
  wolfram_function: IdentityMatrix
  input_converter: to_wl_scalar
  output_converter: from_wl_numpy
  tags: [eye, identity, matrix, torch]
  description: "Identity matrix 单位矩阵"

- python_path: torch.rand
  wolfram_function: RandomReal
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [rand, random, uniform, torch]
  description: "Uniform random tensor [0,1) 均匀随机张量"

- python_path: torch.randn
  wolfram_function: "RandomVariate[NormalDistribution[]]"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [randn, normal, random, torch]
  description: "Standard normal random tensor 标准正态随机张量"

- python_path: torch.randint
  wolfram_function: RandomInteger
  input_converters: [to_wl_scalar, to_wl_list]
  output_converter: from_wl_numpy
  tags: [randint, integer, random, torch]
  description: "Random integer tensor 随机整数张量"

- python_path: torch.manual_seed
  wolfram_function: SeedRandom
  input_converter: to_wl_scalar
  output_converter: from_wl_passthrough
  tags: [seed, random, reproducibility, torch]
  description: "Set random seed 设置随机种子"

# ═══════════════════════════════════════════════════════
#  2. 张量操作 Tensor Ops
# ═══════════════════════════════════════════════════════

- python_path: torch.reshape
  wolfram_function: ArrayReshape
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [reshape, shape, torch]
  description: "Reshape tensor 重塑张量"

- python_path: torch.transpose
  wolfram_function: Transpose
  input_converter: to_wl_matrix
  output_converter: from_wl_numpy
  tags: [transpose, matrix, torch]
  description: "Transpose tensor 转置张量"

- python_path: torch.permute
  wolfram_function: Transpose
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [permute, transpose, axis, torch]
  description: "Permute dimensions 维度置换"

- python_path: torch.flatten
  wolfram_function: Flatten
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [flatten, reshape, torch]
  description: "Flatten tensor 展平张量"

- python_path: torch.squeeze
  wolfram_function: Flatten
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [squeeze, shape, torch]
  description: "Remove size-1 dimensions 去除单维"

- python_path: torch.unsqueeze
  wolfram_function: List
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [unsqueeze, expand, torch]
  description: "Insert new dimension 插入新维度"

- python_path: torch.cat
  wolfram_function: Join
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [cat, concatenate, join, torch]
  description: "Concatenate tensors 连接张量"

- python_path: torch.stack
  wolfram_function: Join
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [stack, join, torch]
  description: "Stack tensors along new dim 沿新维度堆叠"

- python_path: torch.split
  wolfram_function: Partition
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [split, partition, torch]
  description: "Split tensor 分割张量"

- python_path: torch.chunk
  wolfram_function: Partition
  input_converter: to_wl_list
  output_converter: from_wl_json
  tags: [chunk, split, torch]
  description: "Split tensor into chunks 均匀分割"

- python_path: torch.flip
  wolfram_function: Reverse
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [flip, reverse, torch]
  description: "Flip tensor 翻转张量"

- python_path: torch.roll
  wolfram_function: RotateRight
  input_converters: [to_wl_list, to_wl_scalar]
  output_converter: from_wl_numpy
  tags: [roll, rotate, shift, torch]
  description: "Roll tensor elements 循环移位"

- python_path: torch.sort
  wolfram_function: Sort
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [sort, order, torch]
  description: "Sort tensor 排序张量"

- python_path: torch.unique
  wolfram_function: Union
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [unique, distinct, torch]
  description: "Unique elements 唯一元素"

- python_path: torch.where
  wolfram_function: Pick
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [where, conditional, torch]
  description: "Select elements conditionally 条件选择"

- python_path: torch.clamp
  wolfram_function: Clip
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [clamp, clip, torch]
  description: "Clamp values to range 截断值域"

# ═══════════════════════════════════════════════════════
#  3. 数学运算（广播）
# ═══════════════════════════════════════════════════════

- python_path: torch.add
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Plus]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [add, plus, broadcast, torch]
  description: "Add tensors with broadcasting 广播加法"

- python_path: torch.sub
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Subtract]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [sub, subtract, broadcast, torch]
  description: "Subtract tensors with broadcasting 广播减法"

- python_path: torch.mul
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Times]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [mul, multiply, broadcast, torch]
  description: "Multiply tensors with broadcasting 广播乘法"

- python_path: torch.div
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Divide]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [div, divide, broadcast, torch]
  description: "Divide tensors with broadcasting 广播除法"

- python_path: torch.pow
  wolfram_function: "ResourceFunction[\"Broadcasting\"][Power]"
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [pow, power, broadcast, torch]
  description: "Power with broadcasting 广播幂运算"

- python_path: torch.abs
  wolfram_function: Abs
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [abs, absolute, torch]
  description: "Absolute value 绝对值"

- python_path: torch.sqrt
  wolfram_function: Sqrt
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [sqrt, square root, torch]
  description: "Square root 平方根"

- python_path: torch.exp
  wolfram_function: Exp
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [exp, exponential, torch]
  description: "Exponential 指数"

- python_path: torch.log
  wolfram_function: Log
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [log, logarithm, torch]
  description: "Natural log 自然对数"

- python_path: torch.log2
  wolfram_function: "Log[2, #]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [log2, logarithm, torch]
  description: "Base-2 log 以2为底对数"

- python_path: torch.log10
  wolfram_function: "Log[10, #]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [log10, logarithm, torch]
  description: "Base-10 log 以10为底对数"

- python_path: torch.sin
  wolfram_function: Sin
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [sin, trig, torch]
  description: "Sine 正弦"

- python_path: torch.cos
  wolfram_function: Cos
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [cos, trig, torch]
  description: "Cosine 余弦"

- python_path: torch.tanh
  wolfram_function: Tanh
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [tanh, activation, torch]
  description: "Hyperbolic tangent 双曲正切"

# ═══════════════════════════════════════════════════════
#  4. 线性代数
# ═══════════════════════════════════════════════════════

- python_path: torch.dot
  wolfram_function: Dot
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_scalar
  tags: [dot, inner product, torch]
  description: "Dot product 点积"

- python_path: torch.matmul
  wolfram_function: Dot
  input_converters: [to_wl_matrix, to_wl_matrix]
  output_converter: from_wl_numpy
  tags: [matmul, matrix multiply, torch]
  description: "Matrix multiplication 矩阵乘法"

- python_path: torch.mm
  wolfram_function: Dot
  input_converters: [to_wl_matrix, to_wl_matrix]
  output_converter: from_wl_numpy
  tags: [mm, matrix multiply, torch]
  description: "Matrix multiply (2D only) 2D矩阵乘法"

- python_path: torch.bmm
  wolfram_function: Dot
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [bmm, batch matrix multiply, torch]
  description: "Batch matrix multiplication 批矩阵乘法"

- python_path: torch.outer
  wolfram_function: Outer
  input_converters: [to_wl_list, to_wl_list]
  output_converter: from_wl_numpy
  tags: [outer, outer product, torch]
  description: "Outer product 外积"

- python_path: torch.linalg.solve
  wolfram_function: LinearSolve
  input_converters: [to_wl_matrix, to_wl_list]
  output_converter: from_wl_numpy
  tags: [solve, linear algebra, torch]
  description: "Solve linear system 线性方程组"

- python_path: torch.linalg.inv
  wolfram_function: Inverse
  input_converter: to_wl_matrix
  output_converter: from_wl_numpy
  tags: [inv, inverse, matrix, torch]
  description: "Matrix inverse 矩阵逆"

- python_path: torch.linalg.det
  wolfram_function: Det
  input_converter: to_wl_matrix
  output_converter: from_wl_scalar
  tags: [det, determinant, torch]
  description: "Matrix determinant 行列式"

- python_path: torch.linalg.eig
  wolfram_function: Eigensystem
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [eig, eigenvalue, torch]
  description: "Eigendecomposition 特征分解"

- python_path: torch.linalg.svd
  wolfram_function: SingularValueDecomposition
  input_converter: to_wl_matrix
  output_converter: from_wl_json
  tags: [svd, decomposition, torch]
  description: "SVD 奇异值分解"

- python_path: torch.linalg.norm
  wolfram_function: Norm
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [norm, vector, matrix, torch]
  description: "Norm 范数"

# ═══════════════════════════════════════════════════════
#  5. 统计聚合
# ═══════════════════════════════════════════════════════

- python_path: torch.sum
  wolfram_function: Total
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [sum, aggregate, torch]
  description: "Sum of elements 求和"

- python_path: torch.mean
  wolfram_function: Mean
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [mean, average, torch]
  description: "Mean 均值"

- python_path: torch.std
  wolfram_function: StandardDeviation
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [std, standard deviation, torch]
  description: "Standard deviation 标准差"

- python_path: torch.var
  wolfram_function: Variance
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [var, variance, torch]
  description: "Variance 方差"

- python_path: torch.max
  wolfram_function: Max
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [max, maximum, torch]
  description: "Maximum value 最大值"

- python_path: torch.min
  wolfram_function: Min
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [min, minimum, torch]
  description: "Minimum value 最小值"

- python_path: torch.argmax
  wolfram_function: "Ordering[Flatten[#], -1][[1]]&"
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [argmax, index, torch]
  description: "Index of maximum 最大值索引"

- python_path: torch.argmin
  wolfram_function: "Ordering[Flatten[#], 1][[1]]&"
  input_converter: to_wl_list
  output_converter: from_wl_scalar
  tags: [argmin, index, torch]
  description: "Index of minimum 最小值索引"

- python_path: torch.cumsum
  wolfram_function: Accumulate
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [cumsum, cumulative sum, torch]
  description: "Cumulative sum 累积和"

# ═══════════════════════════════════════════════════════
#  6. 激活函数（nn.functional）
# ═══════════════════════════════════════════════════════

- python_path: torch.nn.functional.relu
  wolfram_function: "Map[Max[0, #]&, #, {-1}]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [relu, activation, torch, nn]
  description: "ReLU activation ReLU激活函数"

- python_path: torch.nn.functional.sigmoid
  wolfram_function: "Map[LogisticSigmoid, Flatten[#]]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [sigmoid, activation, torch, nn]
  description: "Sigmoid activation Sigmoid激活"

- python_path: torch.nn.functional.softmax
  wolfram_function: "SoftmaxLayer[][#]&"
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [softmax, activation, torch, nn]
  description: "Softmax activation Softmax激活"

- python_path: torch.nn.functional.tanh
  wolfram_function: Tanh
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [tanh, activation, torch, nn]
  description: "Tanh activation Tanh激活"

- python_path: torch.nn.functional.dropout
  wolfram_function: Identity
  input_converter: to_wl_list
  output_converter: from_wl_numpy
  tags: [dropout, regularization, torch, nn]
  description: "Dropout (eval mode = identity) Dropout（推理时恒等）"
